(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"luD+":function(e,t,a){"use strict";a.r(t),a.d(t,"MessagesModule",function(){return Z});var s=a("tyNb"),c=a("l7P3");const n=Object(c.o)("message"),i=Object(c.q)(n,e=>e.dateFrom),o=Object(c.q)(n,e=>e.selectedRange),r=Object(c.q)(n,e=>e.messages),l=Object(c.q)(n,e=>e.isWaiting),d=Object(c.q)(n,e=>e.incArchived);var b=a("4Zo2"),u=a("0IaG"),h=a("fXoL"),g=a("XiUz"),m=a("bTqV"),f=a("ofXK");let p=(()=>{class e{constructor(e,t){this.dialogRef=e,this.message=t}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(u.g),h.Nb(u.a))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-message-dialog"]],decls:22,vars:9,consts:[["mat-dialog-title",""],["fxLayout","column","fxLayoutAlign","space-even start",1,"setHeight"],["fxLayout","row","fxLayoutAlign","space-around center",1,"fullWidth"],[1,"spacer"],["mat-raised-button","","color","primary",3,"mat-dialog-close"],["mat-raised-button","","color","accent","mat-dialog-close",""]],template:function(e,t){1&e&&(h.Tb(0,"h2",0),h.Cc(1,"Message Details"),h.Sb(),h.Tb(2,"mat-dialog-content"),h.Tb(3,"div",1),h.Tb(4,"div",2),h.Tb(5,"span"),h.Cc(6),h.Sb(),h.Tb(7,"span",3),h.Cc(8,"..... "),h.Sb(),h.Tb(9,"span"),h.Cc(10),h.Sb(),h.Sb(),h.Tb(11,"div"),h.Cc(12),h.Sb(),h.Sb(),h.Sb(),h.Tb(13,"mat-dialog-actions"),h.Tb(14,"span"),h.Cc(15),h.gc(16,"date"),h.Sb(),h.Ob(17,"span",3),h.Tb(18,"button",4),h.Cc(19,"Archive"),h.Sb(),h.Tb(20,"button",5),h.Cc(21,"Close"),h.Sb(),h.Sb()),2&e&&(h.Cb(6),h.Ec(" Subject: ",t.message.subject,""),h.Cb(4),h.Ec("Active status: ",t.message.isActive,""),h.Cb(2),h.Dc(t.message.body),h.Cb(3),h.Fc(" Posted by: ",t.message.postedBy.username," @ ",h.ic(16,6,t.message.datePosted,"HH:mm dd/MM/yyyy")," "),h.Cb(3),h.lc("mat-dialog-close",t.message))},directives:[u.h,u.e,g.c,g.b,u.c,m.a,u.d],pipes:[f.e],styles:[".spacer[_ngcontent-%COMP%]{flex:1 1 auto}.fullWidth[_ngcontent-%COMP%]{width:100%;background-color:#d7defd}.setHeight[_ngcontent-%COMP%]{height:250px}"]}),e})();var C=a("3Pt+"),v=a("ZdSY"),w=a("kmnG"),S=a("qFsG"),y=a("ihCf");let T=(()=>{class e{constructor(e,t){this.dialogRef=e,this.fb=t,this.formdata=this.fb.group({subject:this.fb.control("",[C.p.required,v.a]),body:this.fb.control("",[C.p.required,v.a])})}ngOnInit(){}onCancelClick(){this.dialogRef.close()}onSaveClick(){this.dialogRef.close(this.formdata.value)}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(u.g),h.Nb(C.d))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-message-new-dialog"]],decls:17,vars:3,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"setHeight"],[3,"formGroup"],["matInput","","formControlName","subject","autocomplete","off","placeholder","Subject"],[1,"fullWidth"],["matInput","","formControlName","body","autocomplete","off","placeholder","Message body","cdkTextareaAutosize","","cdkAutosizeMinRows","1","cdkAutosizeMaxRows","11"],["autosize","cdkTextareaAutosize"],["mat-dialog-actions",""],[1,"spacer"],["mat-raised-button","","color","accent",3,"click"],["mat-raised-button","","color","accent",3,"mat-dialog-close","disabled"]],template:function(e,t){1&e&&(h.Tb(0,"h1",0),h.Cc(1,"New Message"),h.Sb(),h.Tb(2,"div",1),h.Tb(3,"form",2),h.Tb(4,"mat-form-field"),h.Ob(5,"input",3),h.Sb(),h.Ob(6,"br"),h.Tb(7,"mat-form-field",4),h.Ob(8,"textarea",5,6),h.Sb(),h.Sb(),h.Sb(),h.Tb(10,"div",7),h.Tb(11,"span",8),h.Cc(12,"..... "),h.Sb(),h.Tb(13,"button",9),h.bc("click",function(){return t.onCancelClick()}),h.Cc(14,"Cancel"),h.Sb(),h.Tb(15,"button",10),h.Cc(16,"Save"),h.Sb(),h.Sb()),2&e&&(h.Cb(3),h.lc("formGroup",t.formdata),h.Cb(12),h.lc("mat-dialog-close",t.formdata.value)("disabled",!t.formdata.valid))},directives:[u.h,u.e,C.q,C.l,C.f,w.b,S.b,C.c,C.k,C.e,y.b,u.c,m.a,u.d],styles:[".spacer[_ngcontent-%COMP%]{flex:1 1 auto}.fullWidth[_ngcontent-%COMP%]{width:100%;background-color:#d7defd}.setHeight[_ngcontent-%COMP%]{height:250px}"]}),e})();var M=a("YRu1"),k=a("M9IT"),D=a("+0xr"),O=a("/t3+");function A(e,t){1&e&&(h.Tb(0,"th",14),h.Cc(1," Subject "),h.Sb())}function R(e,t){if(1&e&&(h.Tb(0,"td",15),h.Cc(1),h.Sb()),2&e){const e=t.$implicit;h.Cb(1),h.Ec(" ",e.subject," ")}}function x(e,t){1&e&&(h.Tb(0,"th",14),h.Cc(1," Body "),h.Sb())}function B(e,t){if(1&e&&(h.Tb(0,"td",15),h.Cc(1),h.Sb()),2&e){const e=t.$implicit;h.Cb(1),h.Ec(" ",e.body," ")}}function F(e,t){1&e&&(h.Tb(0,"th",14),h.Cc(1," Date "),h.Sb())}function $(e,t){if(1&e&&(h.Tb(0,"td",15),h.Cc(1),h.gc(2,"date"),h.Sb()),2&e){const e=t.$implicit;h.Cb(1),h.Ec(" ",h.ic(2,1,e.datePosted,"dd/MM/yyyy")," ")}}function I(e,t){1&e&&(h.Tb(0,"th",14),h.Cc(1," Posted By "),h.Sb())}function j(e,t){if(1&e&&(h.Tb(0,"td",15),h.Cc(1),h.Sb()),2&e){const e=t.$implicit;h.Cb(1),h.Ec(" ",e.postedBy.username," ")}}function N(e,t){1&e&&h.Ob(0,"tr",16)}function P(e,t){if(1&e){const e=h.Ub();h.Tb(0,"tr",17),h.bc("click",function(){h.tc(e);const a=t.$implicit;return h.fc().onRowSelected(a)}),h.Sb()}2&e&&h.Fb("make-red",!t.$implicit.isActive)}const H=function(){return[6]};let _=(()=>{class e{constructor(e,t){this.store=e,this.dialog=t,this.messages=[],this.displayedColumns=["subject","body","date","postedBy"],this.newMessage={subject:"a",body:"x",isActive:!1,postedBy_id:null},this.dateFrom$=this.store.select(i),this.dateFrom$.subscribe(e=>{this.dateFrom=e,this.userId$=this.store.select(b.d),this.userId$.subscribe(e=>this.userId=e)}),this.messages$=this.store.select(r),this.messages$.subscribe(e=>{this.messages=e,this.dataSource=new D.k(this.messages),this.dataSource.paginator=this.paginator})}ngAfterViewInit(){}ngOnInit(){}onRowSelected(e){this.dialog.open(p,{width:"600px",height:"400px",data:e}).afterClosed().subscribe(e=>{if(e)if(e.isActive){const t=e.id;console.log("About to archive "+t),this.store.dispatch(M.a({messageId:t}))}else console.log("message already archived!");else console.log("No data returned!!");e=null})}onNewMessage(){this.dialog.open(T,{width:"600px",height:"400px"}).afterClosed().subscribe(e=>{e?(this.newMessage=e,this.newMessage.isActive=!0,this.newMessage.postedBy_id=this.userId,console.log("The dialog was saved "+this.newMessage.body),this.store.dispatch(M.h({message:this.newMessage}))):console.log("No data returned!!"),e=null})}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(c.h),h.Nb(u.b))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-message-main"]],viewQuery:function(e,t){if(1&e&&h.Gc(k.a,!0),2&e){let e;h.qc(e=h.cc())&&(t.paginator=e.first)}},decls:24,vars:10,consts:[["color","primary"],[1,"spacer"],["mat-raised-button","","color","accent","type","button",3,"click"],[1,"table-container"],["mat-table","",1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","subject"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","body"],["matColumnDef","date"],["matColumnDef","postedBy"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",3,"make-red","click",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"pageSizeOptions"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row","",3,"click"]],template:function(e,t){1&e&&(h.Tb(0,"mat-toolbar",0),h.Tb(1,"span"),h.Cc(2),h.gc(3,"date"),h.Sb(),h.Ob(4,"span",1),h.Tb(5,"button",2),h.bc("click",function(){return t.onNewMessage()}),h.Cc(6,"Add New"),h.Sb(),h.Sb(),h.Tb(7,"div",3),h.Tb(8,"table",4),h.Rb(9,5),h.Bc(10,A,2,0,"th",6),h.Bc(11,R,2,1,"td",7),h.Qb(),h.Rb(12,8),h.Bc(13,x,2,0,"th",6),h.Bc(14,B,2,1,"td",7),h.Qb(),h.Rb(15,9),h.Bc(16,F,2,0,"th",6),h.Bc(17,$,3,4,"td",7),h.Qb(),h.Rb(18,10),h.Bc(19,I,2,0,"th",6),h.Bc(20,j,2,1,"td",7),h.Qb(),h.Bc(21,N,1,0,"tr",11),h.Bc(22,P,1,2,"tr",12),h.Sb(),h.Ob(23,"mat-paginator",13),h.Sb()),2&e&&(h.Cb(2),h.Ec("Messages from ",h.ic(3,6,t.dateFrom,"dd/MM/yyyy"),""),h.Cb(6),h.lc("dataSource",t.dataSource),h.Cb(13),h.lc("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),h.Cb(1),h.lc("matRowDefColumns",t.displayedColumns),h.Cb(1),h.lc("pageSizeOptions",h.nc(9,H)))},directives:[O.a,m.a,D.j,D.c,D.e,D.b,D.g,D.i,k.a,D.d,D.a,D.f,D.h],pipes:[f.e],styles:["table[_ngcontent-%COMP%]{width:100%}.make-red[_ngcontent-%COMP%], .table-container[_ngcontent-%COMP%]{background-color:#faa}.spacer[_ngcontent-%COMP%]{flex:1 1 auto}"]}),e})();const L=[{value:"range_all",viewValue:"All"},{value:"range1",viewValue:"Last week"},{value:"range2",viewValue:"Last fortnight"},{value:"range3",viewValue:"Last 3 weeks"},{value:"range4",viewValue:"Four weeks"},{value:"range_custom",viewValue:"Custom"}];var q=a("d3UM"),z=a("bSwM"),V=a("FKr1"),E=a("iadO"),W=a("Xa2L");function G(e,t){if(1&e&&(h.Tb(0,"mat-option",5),h.Cc(1),h.Sb()),2&e){const e=t.$implicit;h.lc("value",e.value),h.Cb(1),h.Ec(" ",e.viewValue," ")}}function Q(e,t){if(1&e){const e=h.Ub();h.Tb(0,"div"),h.Tb(1,"mat-form-field",0),h.Tb(2,"mat-label"),h.Cc(3,"Choose a date"),h.Sb(),h.Tb(4,"input",6),h.bc("ngModelChange",function(t){return h.tc(e),h.fc().selectedDate=t})("dateChange",function(){return h.tc(e),h.fc().onDateChanged()}),h.Sb(),h.Ob(5,"mat-datepicker-toggle",7),h.Ob(6,"mat-datepicker",null,8),h.Sb(),h.Sb()}if(2&e){const e=h.rc(7),t=h.fc();h.Cb(4),h.lc("matDatepicker",e)("ngModel",t.selectedDate),h.Cb(1),h.lc("for",e)}}function K(e,t){1&e&&(h.Tb(0,"div"),h.Ob(1,"mat-spinner",9),h.Sb())}let U=(()=>{class e{constructor(e){this.store=e,this.ranges=L,this.incArchived=!1}ngOnInit(){this.isWaiting$=this.store.select(l),this.selectedRange$=this.store.select(o),this.selectedRange$.subscribe(e=>{this.selectedRange=e}),this.incArchived$=this.store.select(d),this.incArchived$.subscribe(e=>{this.incArchived=e}),this.selectedDate$=this.store.select(i),this.selectedDate$.subscribe(e=>{this.selectedDate=e}),this.store.dispatch(M.d({dateFrom:this.selectedDate,incArchived:this.incArchived}))}onChange(){switch(this.selectedRange){case"range_all":this.selectedDate=new Date("2021-01-01");break;case"range1":this.selectedDate=new Date((new Date).getTime()-6048e5);break;case"range2":this.selectedDate=new Date((new Date).getTime()-12096e5);break;case"range3":this.selectedDate=new Date((new Date).getTime()-18144e5);break;case"range4":this.selectedDate=new Date((new Date).getTime()-24192e5)}this.store.dispatch(M.m({selectedRange:this.selectedRange})),this.store.dispatch(M.k({dateFrom:this.selectedDate})),this.store.dispatch(M.d({dateFrom:this.selectedDate,incArchived:this.incArchived}))}onDateChanged(){this.store.dispatch(M.k({dateFrom:this.selectedDate})),this.store.dispatch(M.d({dateFrom:this.selectedDate,incArchived:this.incArchived}))}onArchiveChanged(e){this.store.dispatch(M.l({incArchived:e})),console.log("checkbox clicked "+e),this.store.dispatch(M.d({dateFrom:this.selectedDate,incArchived:e}))}}return e.\u0275fac=function(t){return new(t||e)(h.Nb(c.h))},e.\u0275cmp=h.Hb({type:e,selectors:[["app-message-nav"]],decls:13,vars:7,consts:[["appearance","fill"],["name","range",3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"ngModel","ngModelChange","change"],[3,"value"],["matInput","",3,"matDatepicker","ngModel","ngModelChange","dateChange"],["matSuffix","",3,"for"],["picker",""],[2,"margin","0 auto"]],template:function(e,t){1&e&&(h.Tb(0,"h3"),h.Cc(1,"Messages options"),h.Sb(),h.Tb(2,"mat-form-field",0),h.Tb(3,"mat-label"),h.Cc(4,"Date Range"),h.Sb(),h.Tb(5,"mat-select",1),h.bc("ngModelChange",function(e){return t.selectedRange=e})("selectionChange",function(){return t.onChange()}),h.Bc(6,G,2,2,"mat-option",2),h.Sb(),h.Sb(),h.Bc(7,Q,8,3,"div",3),h.Tb(8,"section"),h.Tb(9,"mat-checkbox",4),h.bc("ngModelChange",function(e){return t.incArchived=e})("change",function(e){return t.onArchiveChanged(e.checked)}),h.Cc(10,"Include archived"),h.Sb(),h.Sb(),h.Bc(11,K,2,0,"div",3),h.gc(12,"async")),2&e&&(h.Cb(5),h.lc("ngModel",t.selectedRange),h.Cb(1),h.lc("ngForOf",t.ranges),h.Cb(1),h.lc("ngIf","range_custom"==t.selectedRange),h.Cb(2),h.lc("ngModel",t.incArchived),h.Cb(2),h.lc("ngIf",h.hc(12,5,t.isWaiting$)))},directives:[w.b,w.e,q.a,C.k,C.n,f.k,f.l,z.a,V.l,S.b,E.b,C.c,E.d,w.f,E.a,W.b],pipes:[f.b],styles:[""]}),e})();const X=[{path:"",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=h.Hb({type:e,selectors:[["app-messages"]],decls:5,vars:0,consts:[["fxLayout","row","fxLayoutAlign","space-between start"],["fxFlex","20",1,"container-outer"],["fxFlex","80",1,"content"]],template:function(e,t){1&e&&(h.Tb(0,"div",0),h.Tb(1,"div",1),h.Ob(2,"app-message-nav"),h.Sb(),h.Tb(3,"div",2),h.Ob(4,"router-outlet"),h.Sb(),h.Sb())},directives:[g.c,g.b,g.a,U,s.h],styles:[""]}),e})(),children:[{path:"",component:_}]}];let J=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[s.g.forChild(X)],s.g]}),e})();var Y=a("PCNd");let Z=(()=>{class e{}return e.\u0275mod=h.Lb({type:e}),e.\u0275inj=h.Kb({factory:function(t){return new(t||e)},imports:[[Y.a,J]]}),e})()}}]);